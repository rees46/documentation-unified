# Настройка Apple Wallet

Вам потребуется аккаунт Apple Developer и MacBook, чтобы сгенерировать сертификат Apple Pass. Если с этим есть сложности, обратитесь к нашей команде поддержки.

Краткий план действий:

1. Создаем идентификатор Pass ID
2. Создаем CSR файл
3. Генерируем CER-файл 
4. Импортируем в Keychain
5. Выгружаем сертификат P12
6. Загружаем в личный кабинет

## Создаем идентификатор Pass ID

1. Зайдите в Apple Developer
2. Перейдите в раздел `Certificates, Identifiers & Profiles`
3. Выберите `Identifiers`
4. Нажмите `[+]`
5. Впишите описание (любой текст) и идентификатор пасса, что-то вроде `pass.ru.mywebsite.loyalty` (строка может быть любая, главное чтобы это было похоже на Reverse DNS)
6. Нажмите "Сохранить"

Не закрывайте окно, нам потребуется форма создания сертификата через один шаг.

## Создаем CSR файл

1. Откройте на MacBook приложение `Keychain Access`
2. В меню выберите `Keychain Access > Certificate Assistant > Request a Certificate From a Certificate Authority...`
3. В новом окне в параметре `Request is` выберите вариант `Saved to disk`
4. Сохраните файл `CertificateSigningRequest.certSigningRequest` на жесткий диск, он потребуется на следующем шаге

## Генерируем CER-файл

1. Вернитесь в окно браузера, где вы создали `Pass Identifier` (если закрыли, то откройте `Certificates, Identifiers & Profiles > Identifiers`, справа-сверху вместо `App IDs` выберите `Pass Type IDs`, и кликните в идентификатор, который вы создали ранее)
2. Нажмите кнопку `Create certificate`
3. В имя сертификата впишите что угодно
4. Выберите в поле файла созданный ранее файл `CertificateSigningRequest.certSigningRequest`
5. Нажмите `Continue`
6. На следующем экране скачайте `.cer` файл на жесткий диск

## Импортируем в Keychain

1. Двойной клик на полученный `.cer` файл
2. Откроется `Keychain Access`
3. В секции `login` через поле поиска найдите тот Pass Type ID, который вы создали в секции `Создаем идентификатор Pass ID`

## Выгружаем сертификат P12

1. Правой кнопкой на имя `Pass Type ID`, откроется контекстное меню
2. Выберите `Export "Pass Type ID ..."`
3. Откроется окно с указанием имени файла (по-умолчанию `Certificates`), оставьте его как есть, и формат файла `.p12` тоже. Нажмите `Save`
4. В следующем окне введите пароль к сертификату (обязательно)

## Загружаем в личный кабинет 

1. Откройте в личном кабинете REES46 экран настройки Wallet
2. Скроллируйте вниз, пока не увидите форму загрузки сертификата Apple
3. Выберите файл из предыдущего пункта и введите пароль 
4. Нажмите "Загрузить"
5. Если получили ошибку пароля, значит пароль указан неправильно (проверьте, что не вставляете лишние пробелы)
6. После успешной загрузки вы увидите дату, до которой действует сертификат. Не забывайте проверять ее и загрузить новый сертификат до того, как наступит эта дата, иначе вы не сможете создавать новые пассы

На этом с Apple все. Настройте [Google](./google.md) и можно приступать к [выдаче пассов вашим клиентам](./distribute.md).